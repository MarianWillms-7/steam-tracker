<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steam Activity Tracker</title>
    <link rel="icon" type="image/png" href="img/icon.png">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<video autoplay muted loop playsinline id="bg-video"><source src="img/background.mp4" type="video/mp4"></video>
<div id="video-overlay"></div>

<div id="lightbox" onclick="closeLightbox()">
    <img id="lightboxImg" src="">
</div>

<div id="recapModal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeRecap()">Ã—</span>
        <div class="modal-title">Dein Gaming Jahr</div>
        <div class="modal-stat-label">
            Top Spiel
            <span class="recap-highlight" id="recapTopGame" style="color:var(--accent)">-</span>
        </div>
        <div class="modal-stat-label">
            Gesamtzeit
            <span class="recap-highlight" id="recapTotalTime">- Std</span>
        </div>
        <div class="modal-stat-label">
            Aktivster Tag
            <span class="recap-highlight" id="recapTopDay">-</span>
            <small style="color:var(--text-muted); display:block; margin-top:5px;">
                Gesamtzeit: <span id="recapTopDayVal" style="color:#fff;">0</span> Std
            </small>
        </div>
    </div>
</div>

<div id="userModal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeUserModal()">Ã—</span>
        <div class="modal-title">Freunde hinzufÃ¼gen</div>
        <p style="color:var(--text-muted); line-height:1.6; margin-bottom:20px;">
            FÃ¼ge GitHub Secrets hinzu um mehr Profile zu laden.
        </p>
    </div>
</div>

<div id="shameModal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeShame()">Ã—</span>
        <div class="modal-title" style="color:var(--shame)">ğŸ’¸ Pile of Shame</div>
        <div class="modal-stat-label">Ungespielte Spiele</div>
        <span class="modal-big-val" id="shameCount">0</span>
        <div class="modal-stat-label">GeschÃ¤tzter Wert</div>
        <span class="shame-val" id="shameValueTotal">0,00 â‚¬</span>
        <div style="color:var(--text-muted); font-size:0.8rem; margin-top:-5px;">Im Sale ca.: <span id="shameValueSale" style="color:var(--online)">0,00 â‚¬</span></div>
        <div id="shameProgressContainer" style="display:none;"><div class="shame-progress"><div class="shame-bar" id="shameBar"></div></div><small style="color:var(--text-muted)">Berechne... <span id="shameStatus">0/0</span></small></div>
        <button onclick="calculateShameValue()" class="steam-store-btn" id="btnCalcShame" style="width:100%; margin-top:20px; background:var(--shame);">Wert berechnen</button>
        <div class="shame-list" id="shameList"></div>
    </div>
</div>

<div class="container">
    <div class="online-bar" id="onlineBar"></div>

    <div class="main-grid-layout">
        <div class="left-column">
            
            <header id="mainHeader" class="box-style">
                <div class="header-top-row">
                    <div class="user-info">
                        <div class="user-info-group">
                            <img id="userAvatar" class="header-avatar" src="https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png">
                            <div>
                                <h1 id="userHeaderName">Activity Dashboard <div id="userBadges" class="badges-container"></div></h1>
                                <div class="subtitle">
                                    User: <select id="userSelect" class="user-select" onchange="switchUser(this.value)"><option value="all">Lade...</option></select>
                                    <small style="cursor:pointer; color:var(--accent); margin-left:5px;" onclick="openUserModal()">+</small>
                                </div>
                            </div>
                        </div>
                        <div class="header-actions">
                            <button onclick="showRecap()" class="action-btn">ğŸ“… RÃ¼ckblick</button>
                            <button onclick="showShame()" class="action-btn btn-shame">ğŸ’¸ Pile of Shame</button>
                        </div>
                    </div>
                    
                    <div class="game-status-wrapper" id="statusWrapper" onclick="toggleGameDetails()">
                        <img id="gameCover" class="game-cover" src="" alt="Game Cover">
                        <div class="status-text-area">
                            <div class="status-badge">
                                <div id="statusDot" class="dot"></div>
                                <span id="currentStatus">Lade Status...</span>
                            </div>
                            <div id="gameName"></div>
                        </div>
                        <span id="headerArrow" class="arrow">â–¼</span>
                    </div>
                </div>

                <div class="game-details-expanded" id="gameDetailsExpanded">
                    <div id="gameDetailsContent"></div>
                </div>
            </header>

            <div class="stats-grid">
                <div class="stat-card box-style">
                    <div class="stat-label">Gesamt Online</div>
                    <div class="stat-value" id="totalHours">0h</div>
                    <div style="font-size:0.85rem; color:var(--online); margin-top:5px; font-weight:600;">Heute: <span id="todayHours">0h</span></div>
                </div>
                <div class="stat-card box-style"><div class="stat-label">Top Wochentag</div><div class="stat-value" id="topDay">-</div></div>
                <div class="stat-card box-style"><div class="stat-label">Letztes Update</div><div class="stat-value" id="lastUpdate">-</div></div>
                
                <div class="stat-card box-style" onclick="calcCompletion()" style="cursor:pointer; position:relative; overflow:hidden;">
                    <div class="stat-label">ğŸ† Completion-Rate</div>
                    <div class="stat-value" id="compRateVal" style="font-size:1.8rem; color:var(--star-color)">Start â†»</div>
                    <div id="compSub" style="font-size:0.7rem; color:var(--text-muted); margin-top:5px;">Top 3 Games scannen</div>
                </div>
            </div>

            <div class="box-style records-wrapper">
                <div class="record-item"><span class="record-icon">ğŸ”¥</span><div class="stat-label">LÃ¤ngste Session</div><div class="record-val" id="recLongest">- Std</div></div>
                <div class="record-item"><span class="record-icon">ğŸ¦‰</span><div class="stat-label">Spielertyp</div><div class="record-val" id="recType">-</div></div>
                <div class="record-item"><span class="record-icon">ğŸ“…</span><div class="stat-label">Aktivster Tag</div><div class="record-val" id="recActiveDay">-</div></div>
            </div>

            <div class="library-section box-style">
                <input type="checkbox" id="lib-toggle">
                <label for="lib-toggle" class="library-header"><div style="display:flex; align-items:center; gap:10px;"><span>ğŸ® Spiele-Bibliothek</span></div><span class="arrow">â–¼</span></label>
                <div class="library-content">
                    <div class="lib-controls">
                        <input type="text" id="libSearch" class="lib-search" placeholder="Suche nach Namen..." onkeyup="filterLibrary()">
                        <button class="lib-sort-btn" onclick="sortLibrary('name')">Name (A-Z)</button>
                    </div>
                    <div id="gameLibraryList"><div style="text-align:center; padding:20px; color:#94a3b8;">Lade Bibliothek...</div></div>
                </div>
            </div>

            <div class="controls-wrapper box-style">
                <div style="display:flex; gap:10px;">
                    <button onclick="setChartType('daily')" class="type-btn active" id="btn-daily">ğŸ“Š TÃ¤glich</button>
                    <button onclick="setChartType('hourly')" class="type-btn" id="btn-hourly">ğŸ•’ Uhrzeiten</button>
                </div>
                <div style="display:flex; gap:10px;">
                    <button onclick="setTimeRange(0)" class="time-btn" id="btn-0">Heute</button>
                    <button onclick="setTimeRange(7)" class="time-btn active" id="btn-7">7 Tage</button>
                    <button onclick="setTimeRange(30)" class="time-btn" id="btn-30">30 Tage</button>
                    <button onclick="setTimeRange(9999)" class="time-btn" id="btn-all">Alle</button>
                </div>
                <button onclick="loadData()" class="refresh-btn">ğŸ”„ Refresh</button>
            </div>

            <div class="charts-container">
                <div class="card bar-chart-card box-style">
                    <h3>AktivitÃ¤tsverlauf</h3><canvas id="myChart"></canvas><div id="loading">Lade Daten...</div>
                </div>
                <div class="card pie-chart-card box-style">
                    <h3>Tages-Analyse (24h)</h3>
                    <div class="pie-chart-wrapper"><canvas id="myPieChart"></canvas></div>
                    <div class="day-score"><div class="day-score-val" id="dayPercentage">0%</div><div class="day-score-label">des Tages am PC verbracht</div></div>
                </div>
            </div>

            <div class="box-style heatmap-container">
                <h3 style="text-align:left; margin-bottom:10px;">Jahres-AktivitÃ¤t</h3>
                <div class="heatmap-grid" id="heatmapGrid"></div>
            </div>

        </div>

        <div class="right-column">
            <div class="leaderboard-card">
                <div class="lb-title">ğŸ† Top der Woche (7T)</div>
                <div id="lb-week">Lade...</div>
            </div>
            
            <div class="leaderboard-card">
                <div class="lb-title">ğŸ“š GrÃ¶ÃŸte Bibliothek</div>
                <div id="lb-lib">Lade...</div>
            </div>

            <div class="leaderboard-card">
                <div class="lb-title">ğŸ’¸ Meiste ungespielte Games</div>
                <div id="lb-shame">Lade...</div>
            </div>
        </div>
    </div>

    <div class="footer-info" id="footerInfo">Lade Historie...</div>
</div>

<script src="js/app.js"></script>

</body>
</html>
